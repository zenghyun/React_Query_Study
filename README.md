# React_Query_Study
React_Query_study 🔥🔥

리액트 쿼리는 클라이언트에서 서버 데이터 캐시를 관리합니다.
리액트 코드에 서버 데이터가 필요할 때 Fetch나 Axios를 사용해 서버로 바로 이동하지 않고 React Query 캐시를 요청합니다. 

**React Query의 역할은 React Query 클라이언트를 어떻게 구성했느냐에 따라 해당 캐시의 데이터를 유지 관리하는 것입니다.** 

데이터를 관리하는 것은 React Query이지만 서버의 새 데이터로 캐시를 업데이트하는 시기를 설정하는 것은 사용자의 몫입니다. 

데이터 관리뿐만 아니라 React Query에는 서버 상태 관리에 도움이 되는 많은 도구가 함께 제공됩니다. 

1. 서버에 대한 모든 쿼리의 로딩 및 오류 상태를 유지해주기 때문에 수동으로 할 필요가 없어집니다.

2. 사용자를 위해 데이터의 Pagination 또는 무한 스크롤이 필요한 경우 데이터를 조각으로 가져올 수 있는 도구도 제공합니다.

3. 서버에서 데이터의 변이(Mutation)나 업데이트를 관리할 수 있습니다. 쿼리는 키로 식별되기 때문에 React Query는 요청을 관리할 수 있고 페이지를 로드하고 해당 페이지의 여러 구성 요소가 동일한 데이터를 요청하는 경우 React Query는 쿼리를 한 번에 보낼 수 있습니다. 기존 쿼리가 나가는 동안 다른 구성 요소가 데이터를 요청하는 경우 React Query는 중복 요청을 제거할 수 있습니다. 

4. 서버에서 오류가 발생하는 경우에 대한 재시도를 관리할 수 있으며, 쿼리가 성공하거나 오류가 났을 때를 구별해서 조치를 취할 수 있도록 콜백을 전달할 수도 있습니다. 

<br>

## isFetching vs isLoading 

### isFetching 
isFetching은 비동기 쿼리가 해결되지 않았음을 의미합니다. 이 경우에는 아직 Fetching을 완료하지 않았다는 의미이지만, 쿼리가 Axios 호출 또는 GraphQl 호출일 수도 있습니다. 

### isLoading
**isLoading은 isFetching의 하위 집합입니다.** isLoading은 가져오는 상태에 있음을 의미합니다. 쿼리 함수가 아직 해결되지 않았으며, 캐시된 데이터도 없는 상태입니다.

<br>

## staleTime 
만료된 데이터란 무엇인가요? 

React Query에서 데이터가 만료됐다는 건 무슨 뜻일까요? 

데이터 리페칭(ReFetching)은 만료된 데이터에서만 실행됩니다. 

데이터 리페칭 실행에는 만료된 데이터 외에도 컴포넌트가 다시 마운트되거나 윈도우가 다시 포커스되었을 때가 있습니다. 

단, 만료된 데이터일 경우에만 리페칭이 실행됩니다. 

staleTime이란 데이터가 만료됐다고 판단하기 전까지 허용하는 시간이 staleTime입니다. 

예를 들어 웹사이트에 표시된 데이터가 10초까지는 그대로여도 괜찮다면 staleTime을 10초로 설정합니다. 

보통은 리페칭이 실행될 경우라도 데이터가 만료되지 않으면 리페칭은 실행되지 않습니다. 

데이터가 만료된 경우에만 시작됩니다. 


<br>

## staleTime vs cacheTime
- staleTime은 다시 가져오기 위한 것입니다.
- 캐시는 나중에 재사용할 수 있는 데이터용입니다.
  - 특정 쿼리에 대한 활성 useQuery가 없으면 쿼리는 "콜드 스토리지"로 이동합니다.
  - 구성된 cacheTime이 지나면 캐시의 데이터가 만료됩니다(기본값: 5분).
    - cacheTime이 관찰하는 시간의 양은 특정 쿼리에 대한 useQuery가 활성화된 후 경과한 시간입니다. (페이지에 표시되는 컴포넌트가 특정 쿼리에 대해 useQuery를 사용한 시간을 말합니다.)
  - 캐시가 만료되면 가비지 컬렉션이 실행되고 클라이언트는 데이터를 사용할 수 없습니다. 
- 캐시는 가져오는 동안 표시할 백업 데이터입니다.

